(()=>{var e={};e.id=931,e.ids=[931],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},88827:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>c,pages:()=>p,routeModule:()=>x,tree:()=>d}),r(90908),r(899),r(35866);var o=r(23191),n=r(88716),a=r(37922),i=r.n(a),s=r(95231),l={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>s[e]);r.d(t,l);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,90908)),"C:\\Users\\user\\Desktop\\linebot_03\\333\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,899)),"C:\\Users\\user\\Desktop\\linebot_03\\333\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],p=["C:\\Users\\user\\Desktop\\linebot_03\\333\\app\\page.tsx"],c="/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new o.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5568:(e,t,r)=>{Promise.resolve().then(r.bind(r,88743))},68629:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},35303:()=>{},88743:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var o=r(10326),n=r(17577);function a({feeId:e,onSuccess:t}){let[r,a]=(0,n.useState)(!1),[i,s]=(0,n.useState)(null),l=async()=>{a(!0),s(null);try{let r=await fetch("/api/remind-fee",{method:"POST",headers:{"Content-Type":"application/json","x-admin-key":process.env.NEXT_PUBLIC_ADMIN_API_KEY||""},body:JSON.stringify({feeId:e})}),o=await r.json();r.ok?(s("已送出催繳訊息"),t&&t()):s(`失敗：${o.error}`)}catch(e){s(`例外：${e.message}`)}finally{a(!1)}};return(0,o.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px"},children:[o.jsx("button",{onClick:l,disabled:r,style:{padding:"8px 16px",borderRadius:"6px",border:"none",backgroundColor:r?"#ccc":"#FF5722",color:"white",fontSize:"14px",fontWeight:"bold",cursor:r?"not-allowed":"pointer"},children:r?"送出中…":"催繳"}),i&&o.jsx("small",{style:{color:i.includes("失敗")||i.includes("例外")?"red":"green",fontSize:"12px"},children:i})]})}function i({onPush:e}){let[t,r]=(0,n.useState)(!1),[a,i]=(0,n.useState)(null),[s,l]=(0,n.useState)(""),[d,p]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[x,g]=(0,n.useState)(""),[h,b]=(0,n.useState)(""),y=async t=>{t.preventDefault(),r(!0),i(null);try{let t=await fetch("/api/packages",{method:"POST",headers:{"Content-Type":"application/json","x-admin-key":process.env.NEXT_PUBLIC_ADMIN_API_KEY||""},body:JSON.stringify({courier:s,recipient_name:d,recipient_room:c,tracking_number:x,arrived_at:h})}),r=await t.json();t.ok?(i("✅ 包裹已新增並推播給住戶！"),l(""),p(""),u(""),g(""),b(""),e&&e()):i(`❌ 推播失敗：${r.error}`)}catch(e){i(`❌ 系統錯誤：${e.message}`)}finally{r(!1)}};return(0,o.jsxs)("form",{onSubmit:y,style:{display:"flex",flexDirection:"column",gap:"10px",alignItems:"flex-start"},children:[o.jsx("input",{type:"text",placeholder:"快遞公司",value:s,onChange:e=>l(e.target.value),style:{padding:"8px",borderRadius:"6px",border:"1px solid #ccc",width:"100%"},required:!0}),o.jsx("input",{type:"text",placeholder:"收件人",value:d,onChange:e=>p(e.target.value),style:{padding:"8px",borderRadius:"6px",border:"1px solid #ccc",width:"100%"},required:!0}),o.jsx("input",{type:"text",placeholder:"房號",value:c,onChange:e=>u(e.target.value),style:{padding:"8px",borderRadius:"6px",border:"1px solid #ccc",width:"100%"},required:!0}),o.jsx("input",{type:"text",placeholder:"追蹤號碼",value:x,onChange:e=>g(e.target.value),style:{padding:"8px",borderRadius:"6px",border:"1px solid #ccc",width:"100%"}}),o.jsx("input",{type:"datetime-local",placeholder:"到達時間",value:h,onChange:e=>b(e.target.value),style:{padding:"8px",borderRadius:"6px",border:"1px solid #ccc",width:"100%"},required:!0}),o.jsx("button",{type:"submit",disabled:t,style:{padding:"8px 16px",borderRadius:"6px",border:"none",backgroundColor:t?"#ccc":"#9C27B0",color:"white",fontSize:"14px",fontWeight:"bold",cursor:t?"not-allowed":"pointer",width:"100%"},children:t?"推播中…":"儲存並推播包裹"}),a&&o.jsx("small",{style:{color:a.includes("失敗")||a.includes("錯誤")?"red":"green",fontSize:"12px"},children:a})]})}function s(){let[e,t]=(0,n.useState)(""),[r,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[p,c]=(0,n.useState)(!1),[u,x]=(0,n.useState)(""),[g,h]=(0,n.useState)(""),[b,y]=(0,n.useState)(""),[m,f]=(0,n.useState)(""),[v,j]=(0,n.useState)(!1),[S,w]=(0,n.useState)(""),[C,_]=(0,n.useState)(""),[P,k]=(0,n.useState)(""),[R,A]=(0,n.useState)(""),[T,B]=(0,n.useState)(""),[D,I]=(0,n.useState)(!1),[N,q]=(0,n.useState)(""),[E,O]=(0,n.useState)(null),[F,$]=(0,n.useState)(""),[z,U]=(0,n.useState)(""),[W,G]=(0,n.useState)(""),[J,L]=(0,n.useState)(""),[M,X]=(0,n.useState)(""),[K,Y]=(0,n.useState)(!1),[H,Q]=(0,n.useState)(""),V=async o=>{o.preventDefault(),c(!0),x("");try{let o=await fetch("/api/announce",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,content:r,author:l})}),n=await o.json();o.ok?(x("✅ 公告已發布並推播到 LINE Bot！"),t(""),s(""),d("")):x(`❌ 錯誤：${n.error||"無法發布公告"}`)}catch(e){x(`❌ 系統錯誤：${e.message}`)}finally{c(!1)}},Z=async e=>{e.preventDefault(),j(!0),w("");try{let e=await fetch("/api/votes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:g,ends_at:b,form_url:m})}),t=await e.json();e.ok?(w("✅ 問卷連結已通知 LINE Bot！"),h(""),y(""),f("")):w(`❌ 錯誤：${t.error||"無法發送問卷連結"}`)}catch(e){w(`❌ 系統錯誤：${e.message}`)}finally{j(!1)}},ee=async e=>{e.preventDefault(),I(!0),q(""),O(null);try{let e=await fetch("/api/fees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room:C,amount:parseFloat(P),due:R,invoice:T})}),t=await e.json();e.ok?(q("✅ 管理費已新增並推播到 LINE Bot！"),O(t.id||t.feeId),_(""),k(""),A(""),B("")):q(`❌ 錯誤：${t.error||"無法新增管理費"}`)}catch(e){q(`❌ 系統錯誤：${e.message}`)}finally{I(!1)}};return(0,o.jsxs)("main",{style:{padding:"40px 20px",maxWidth:"900px",margin:"50px auto",fontFamily:"Arial, sans-serif"},children:[(0,o.jsxs)("section",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"40px"},children:[o.jsx("h2",{style:{textAlign:"center",marginBottom:"20px",color:"#333"},children:"發布公告"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[o.jsx("input",{type:"text",placeholder:"公告標題",value:e,onChange:e=>t(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("textarea",{placeholder:"公告內容",value:r,onChange:e=>s(e.target.value),rows:4,style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("input",{type:"text",placeholder:"發布者",value:l,onChange:e=>d(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("button",{onClick:V,disabled:p,style:{padding:"12px",borderRadius:"8px",border:"none",backgroundColor:p?"#ccc":"#2196F3",color:"white",fontSize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%"},children:p?"發布中...":"儲存公告並推播"})]}),u&&o.jsx("p",{style:{marginTop:"15px",textAlign:"center",color:u.includes("錯誤")?"red":"green"},children:u})]}),(0,o.jsxs)("section",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"40px"},children:[o.jsx("h2",{style:{textAlign:"center",marginBottom:"20px",color:"#333"},children:"發起問卷連結通知"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[o.jsx("input",{type:"text",placeholder:"問卷標題",value:g,onChange:e=>h(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("input",{type:"datetime-local",placeholder:"截止時間",value:b,onChange:e=>y(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("input",{type:"url",placeholder:"Google Form 網址",value:m,onChange:e=>f(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("button",{onClick:Z,disabled:v,style:{padding:"12px",borderRadius:"8px",border:"none",backgroundColor:v?"#ccc":"#4CAF50",color:"white",fontSize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%"},children:v?"通知中...":"發起問卷連結通知"})]}),S&&o.jsx("p",{style:{marginTop:"15px",textAlign:"center",color:S.includes("錯誤")?"red":"green"},children:S})]}),(0,o.jsxs)("section",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"40px"},children:[o.jsx("h2",{style:{textAlign:"center",marginBottom:"20px",color:"#333"},children:"新增管理費"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[o.jsx("input",{type:"text",placeholder:"房號",value:C,onChange:e=>_(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("input",{type:"number",placeholder:"金額",value:P,onChange:e=>k(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("input",{type:"date",placeholder:"到期日",value:R,onChange:e=>A(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("input",{type:"text",placeholder:"發票號碼",value:T,onChange:e=>B(e.target.value),style:{padding:"12px",borderRadius:"8px",border:"1px solid #ccc",width:"100%"}}),o.jsx("button",{onClick:ee,disabled:D,style:{padding:"12px",borderRadius:"8px",border:"none",backgroundColor:D?"#ccc":"#FF9800",color:"white",fontSize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%"},children:D?"新增中...":"儲存管理費並推播"})]}),N&&(0,o.jsxs)("div",{style:{marginTop:"15px",textAlign:"center"},children:[o.jsx("p",{style:{color:N.includes("錯誤")?"red":"green",marginBottom:"10px"},children:N}),E&&(0,o.jsxs)("div",{style:{marginTop:"10px"},children:[o.jsx("p",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"需要催繳此筆管理費嗎?"}),o.jsx(a,{feeId:E,onSuccess:()=>O(null)})]})]})]}),(0,o.jsxs)("section",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"40px"},children:[o.jsx("h2",{style:{textAlign:"center",marginBottom:"20px",color:"#333"},children:"推播包裹通知"}),o.jsx(i,{onPush:()=>{}})]})]})}},90908:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});let o=(0,r(68570).createProxy)(String.raw`C:\Users\user\Desktop\linebot_03\333\app\page.tsx#default`)},899:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var o=r(19510);function n({children:e}){return o.jsx("html",{lang:"en",children:o.jsx("body",{style:{fontFamily:"sans-serif",margin:0},children:e})})}}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[948,471],()=>r(88827));module.exports=o})();